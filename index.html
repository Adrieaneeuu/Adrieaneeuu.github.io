<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Index pentru director</title>
  <style>
    body {
      background: #0d1117;
      color: #e6edf3;
      font-family: "Segoe UI", system-ui, sans-serif;
      padding: 30px;
      max-width: 900px;
      margin: auto;
    }
    h1 { color: #ff4d4d; font-size: 1.8rem; margin-bottom: 10px; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { padding: 10px; text-align: left; border-bottom: 1px solid #30363d; }
    th { color: #aaa; }
    a { color: #58a6ff; text-decoration: none; }
    a:hover { text-decoration: underline; }
    .folder { color: #ffa657; }
    .file { color: #9cdcfe; }
    .desc { color: #8b949e; font-size: 0.9rem; margin-top: 15px; }
    button { background: #21262d; color: #fff; border: 1px solid #30363d; border-radius: 6px; padding: 6px 10px; cursor: pointer; }
    button:hover { background: #30363d; }
  </style>
</head>
<body>
  <h1>ğŸ“‚ Index pentru directorul curent</h1>
  <div id="repoPath" class="desc">Se Ã®ncarcÄƒ...</div>
  <table>
    <thead><tr><th>Nume</th><th>Dimensiune</th><th>AcÈ›iune</th></tr></thead>
    <tbody id="list"></tbody>
  </table>

<script>
(async () => {
  const defaultOwner = "Adrieaneeuu";
  const defaultRepo = "Adrieaneeuu.github.io";
  const defaultBranch = "main";
  const siteBase = "https://adrieaneeuu.github.io"; // ğŸŒ baza domeniului final

  // extrage calea relativÄƒ din URL (ex: l.rom/)
  let currentPath = window.location.pathname.replace(/^\/+|\/+$/g, "");
  if (currentPath.toLowerCase().startsWith(defaultRepo.toLowerCase() + "/"))
    currentPath = currentPath.slice(defaultRepo.length + 1);

  document.getElementById("repoPath").textContent =
    "Director: /" + (currentPath || "(rÄƒdÄƒcinÄƒ)") +
    "  â€¢  Repo: " + defaultOwner + "/" + defaultRepo;

  const apiUrl = `https://api.github.com/repos/${defaultOwner}/${defaultRepo}/contents/${currentPath}?ref=${defaultBranch}`;
  const res = await fetch(apiUrl);
  const tbody = document.getElementById("list");

  if (!res.ok) {
    tbody.innerHTML = `<tr><td colspan="3">âŒ Eroare (${res.status})</td></tr>`;
    return;
  }

  const files = await res.json();
  files.sort((a, b) => a.type.localeCompare(b.type) || a.name.localeCompare(b.name));

  tbody.innerHTML = "";

  for (const f of files) {
    const tr = document.createElement("tr");

    const tdName = document.createElement("td");
    const link = document.createElement("a");
    link.textContent = f.name;

    if (f.type === "dir") {
      link.href = "./" + f.name + "/"; // navigare localÄƒ
      link.className = "folder";
    } else {
      link.className = "file";
      // construim link absolut corect spre GitHub Pages
      const fileUrl = `${siteBase}/${currentPath ? currentPath + "/" : ""}${f.name}`;

      link.href = fileUrl;
      if (!f.name.endsWith(".html")) link.download = f.name;
    }
    tdName.appendChild(link);

    const tdSize = document.createElement("td");
    tdSize.textContent = f.size ? Math.round(f.size / 1024) + " KB" : "-";

    const tdAction = document.createElement("td");
    if (f.type === "file") {
      const btn = document.createElement("button");
      if (f.name.endsWith(".html")) {
        btn.textContent = "Deschide";
        btn.onclick = () =>
          window.open(`${siteBase}/${currentPath ? currentPath + "/" : ""}${f.name}`, "_blank");
      } else {
        btn.textContent = "DescarcÄƒ";
        btn.onclick = () =>
          window.open(`${siteBase}/${currentPath ? currentPath + "/" : ""}${f.name}`, "_blank");
      }
      tdAction.appendChild(btn);
    } else {
      tdAction.textContent = "ğŸ“";
    }

    tr.append(tdName, tdSize, tdAction);
    tbody.appendChild(tr);
  }
})();
</script>
</body>
</html>
